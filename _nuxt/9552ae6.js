(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{219:function(t,e,r){"use strict";r.r(e);r(33);var n=r(6),o=r(26),c=r(58),l=r(24);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}var f={name:"user-info",props:{article:{type:Object,required:!0,default:function(){return{}}}},data:function(){return{isFetching:!1,isMe:!1}},created:function(){(this.userInfo&&this.userInfo.username)===this.article.author.username&&(this.isMe=!0)},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(l.e)(["userInfo"])),methods:{onFollow:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,o,l,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.userInfo){e.next=3;break}return t.$router.push({path:"/login"}),e.abrupt("return");case 3:if(r=t.article.author,n=r.username,o=r.following,t.isFetching=!0,!o){e.next=11;break}return e.next=8,Object(c.n)(n);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,Object(c.f)(n);case 13:e.t0=e.sent;case 14:l=e.t0,data=l.data,t.isFetching=!1,t.article.author=data.profile;case 18:case"end":return e.stop()}}),e)})))()},deleteArticle:function(){var t=this;this.isFetching=!0,Object(c.d)(this.article.slug).then((function(){t.$router.push({name:"home"}),t.isFetching=!1})).catch((function(){t.isFetching=!1}))},onAddFav:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.userInfo){e.next=3;break}return t.$router.push({path:"/login"}),e.abrupt("return");case 3:if(r=t.article,n=r.slug,o=r.favorited,l=r.favoritesCount,t.article.favorited=!o,t.article.favoritesCount=o?l-1:l+1,t.isFetching=!0,!o){e.next=12;break}return e.next=10,Object(c.e)(n);case 10:e.next=14;break;case 12:return e.next=14,Object(c.b)(n);case 14:t.isFetching=!1;case 15:case"end":return e.stop()}}),e)})))()}}},v=r(14),component=Object(v.a)(f,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"article-meta"},[r("NuxtLink",{attrs:{to:{path:"/profile/"+(t.article.author&&t.article.author.username)}}},[r("img",{attrs:{src:t.article.author&&t.article.author.image}})]),t._v(" "),r("div",{staticClass:"info"},[r("NuxtLink",{staticClass:"author",attrs:{to:{path:"/profile/"+(t.article.author&&t.article.author.username)}}},[t._v(t._s(t.article.author&&t.article.author.username))]),t._v(" "),r("span",{staticClass:"date"},[t._v(t._s(t.article.createdAt))])],1),t._v(" "),t.isMe?[r("span",[r("NuxtLink",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{to:{path:"/operate",query:{slug:t.article.slug}}}},[r("i",{staticClass:"ion-edit"}),t._v(" "),r("span",[t._v(" Edit Article")])]),t._v(" "),r("span",[t._v("  ")]),t._v(" "),r("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{disabled:t.isFetching},on:{click:t.deleteArticle}},[r("i",{staticClass:"ion-trash-a"}),t._v(" "),r("span",[t._v(" Delete Article")])])],1)]:[t.article.author&&t.article.author.following?r("button",{staticClass:"btn btn-sm btn-outline-secondary",on:{click:t.onFollow}},[r("i",{staticClass:"ion-plus-round"}),t._v("\n        UnFollow "+t._s(t.article.author&&t.article.author.username)+"\n    ")]):r("button",{staticClass:"btn btn-sm btn-outline-secondary",on:{click:t.onFollow}},[r("i",{staticClass:"ion-plus-round"}),t._v("\n        Follow "+t._s(t.article.author&&t.article.author.username)+"\n    ")]),t._v("\n      \n    "),r("button",{staticClass:"btn btn-sm btn-outline-primary",on:{click:function(e){return t.onAddFav()}}},[r("i",{staticClass:"ion-heart"}),t._v("\n        Favorite Article\n      "),r("span",{staticClass:"counter"},[t._v("("+t._s(t.article.favoritesCount)+")")])])]],2)}),[],!1,null,null,null);e.default=component.exports},228:function(t,e,r){"use strict";r.r(e);r(10),r(47),r(59);var n=r(26),o=r(45),c=(r(33),r(6)),l=r(58),m={name:"comment-component",props:{commentArr:{type:Array,default:function(){return[]},required:!0}},methods:{}},f=r(14),v=Object(f.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",t._l(t.commentArr,(function(e,n){return r("div",{key:n,staticClass:"article-actions"},[t._m(0,!0)])})),0)}),[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"article-meta"},[r("a",{attrs:{href:"profile.html"}},[r("img",{attrs:{src:"http://i.imgur.com/Qr71crq.jpg"}})]),t._v(" "),r("div",{staticClass:"info"},[r("a",{staticClass:"author",attrs:{href:""}},[t._v("Eric Simons")]),t._v(" "),r("span",{staticClass:"date"},[t._v("January 20th")])]),t._v(" "),r("button",{staticClass:"btn btn-sm btn-outline-secondary"},[r("i",{staticClass:"ion-plus-round"}),t._v("\n          Follow Eric Simons "),r("span",{staticClass:"counter"},[t._v("(10)")])]),t._v("\n       \n      "),r("button",{staticClass:"btn btn-sm btn-outline-primary"},[r("i",{staticClass:"ion-heart"}),t._v("\n          Favorite Post "),r("span",{staticClass:"counter"},[t._v("(29)")])])])}],!1,null,null,null).exports,d=r(219),h=r(24);function _(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}var C={name:"articles",components:{Comment:v,UserInfo:d.default},asyncData:function(t){return Object(c.a)(regeneratorRuntime.mark((function e(){var r,n,c,m,f,v,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.route.params.slug,e.next=3,Promise.all([Object(l.h)(r),Object(l.g)(r)]);case 3:return n=e.sent,c=Object(o.a)(n,2),m=c[0],f=c[1],v=m.data.article,d=f.data.comments,e.abrupt("return",{articles:v,comments:d});case 10:case"end":return e.stop()}}),e)})))()},data:function(){return{body:""}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(h.e)(["userInfo"])),methods:{onSubCom:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function r(){var n,data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.body){r.next=3;break}return alert("请输入评论内容再次发送"),r.abrupt("return");case 3:return r.next=5,Object(l.a)({comment:t},e.$route.params.slug);case 5:n=r.sent,data=n.data,e.comments.push(data.comment),e.body="";case 9:case"end":return r.stop()}}),r)})))()}}},O=Object(f.a)(C,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"article-page"},[r("div",{staticClass:"banner"},[r("div",{staticClass:"container"},[r("h1",[t._v(t._s(t.articles.title))]),t._v(" "),r("UserInfo",{attrs:{article:t.articles}})],1)]),t._v(" "),r("div",{staticClass:"container page"},[r("div",{staticClass:"row article-content"},[r("div",{staticClass:"col-md-12"},[r("p",[t._v("\n          "+t._s(t.articles.body)+"\n        ")])])]),t._v(" "),r("hr"),t._v(" "),r("div",{staticClass:"article-actions"},[r("UserInfo",{attrs:{article:t.articles}})],1),t._v(" "),t.userInfo?r("div",{staticClass:"row"},[r("div",{staticClass:"col-xs-12 col-md-8 offset-md-2"},[r("form",{staticClass:"card comment-form",on:{submit:function(e){return e.preventDefault(),t.onSubCom({body:t.body})}}},[r("div",{staticClass:"card-block"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.body,expression:"body"}],staticClass:"form-control",attrs:{placeholder:"Write a comment...",rows:"3"},domProps:{value:t.body},on:{input:function(e){e.target.composing||(t.body=e.target.value)}}})]),t._v(" "),r("div",{staticClass:"card-footer"},[r("img",{staticClass:"comment-author-img",attrs:{src:t.userInfo.image}}),t._v(" "),r("button",{staticClass:"btn btn-sm btn-primary"},[t._v("Post Comment")])])]),t._v(" "),t._l(t.comments,(function(e,n){return r("div",{key:n,staticClass:"card"},[r("div",{staticClass:"card-block"},[r("p",{staticClass:"card-text"},[t._v("\n              "+t._s(e.body)+"\n            ")])]),t._v(" "),r("div",{staticClass:"card-footer"},[r("NuxtLink",{staticClass:"comment-author",attrs:{to:{path:"/profile/"+e.author.username}}},[r("img",{staticClass:"comment-author-img",attrs:{src:e.author.image}})]),t._v("\n             \n            "),r("NuxtLink",{staticClass:"comment-author",attrs:{to:{path:"/profile/"+e.author.username}}},[t._v(t._s(e.author.username))]),t._v(" "),r("span",{staticClass:"date-posted"},[t._v(t._s(e.createdAt))])],1)])}))],2)]):t._e()])])}),[],!1,null,null,null);e.default=O.exports;installComponents(O,{UserInfo:r(219).default})}}]);